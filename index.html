<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Energy Savings Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #533a71 100%);
            color: #ffffff;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(120, 219, 226, 0.1) 0%, transparent 50%);
            z-index: -1;
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(120deg); }
            66% { transform: translateY(10px) rotate(240deg); }
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 1s ease-out;
        }

        .header h1 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 700;
            background: linear-gradient(135deg, #00d4ff, #7c77c6, #ff77c6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            animation: glow 3s ease-in-out infinite alternate;
        }

        .header h2 {
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            color: #b0b3d1;
            margin-bottom: 15px;
            font-weight: 400;
        }

        .header p {
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            color: #8a8eb5;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        @keyframes glow {
            0% { filter: brightness(1) drop-shadow(0 0 20px rgba(120, 119, 198, 0.3)); }
            100% { filter: brightness(1.2) drop-shadow(0 0 30px rgba(120, 119, 198, 0.5)); }
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .calculator-card {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3), 0 0 40px rgba(120, 119, 198, 0.1);
            animation: fadeInUp 1s ease-out 0.3s both;
            position: relative;
            overflow: hidden;
        }

        .calculator-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .nav-container {
            margin-bottom: 30px;
        }

        .nav-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
        }

        .nav-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            height: 2px;
            background: linear-gradient(90deg, rgba(120, 119, 198, 0.3) 0%, rgba(120, 119, 198, 0.1) 100%);
            z-index: 1;
        }

        .nav-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-step:hover {
            transform: translateY(-2px);
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .step-circle.active {
            background: linear-gradient(135deg, #00d4ff, #7c77c6);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 20px rgba(120, 119, 198, 0.4);
        }

        .step-label {
            font-size: 12px;
            color: #8a8eb5;
            text-align: center;
            transition: color 0.3s ease;
        }

        .nav-step.active .step-label {
            color: #b0b3d1;
        }

        .progress-container {
            margin-top: 20px;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff, #7c77c6, #ff77c6);
            border-radius: 4px;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-text {
            font-size: 14px;
            color: #8a8eb5;
            font-weight: 500;
        }

        .screen-container {
            min-height: 400px;
            position: relative;
            overflow: hidden;
        }

        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            opacity: 0;
            transform: translateX(30px);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
        }

        .screen.active {
            opacity: 1;
            transform: translateX(0);
            pointer-events: all;
        }

        .screen.prev {
            transform: translateX(-30px);
        }

        .screen-title {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            font-weight: 600;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #ffffff, #b0b3d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .screen-description {
            font-size: 1.1rem;
            color: #8a8eb5;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .usage-patterns-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .usage-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .usage-card:hover {
            transform: translateY(-8px);
            border-color: rgba(120, 119, 198, 0.4);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3), 0 0 40px rgba(120, 119, 198, 0.2);
        }

        .usage-card.selected {
            background: rgba(120, 119, 198, 0.1);
            border-color: #7c77c6;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4), 0 0 40px rgba(120, 119, 198, 0.4);
            transform: translateY(-4px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2), rgba(124, 119, 198, 0.2));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.3s ease;
        }

        .card-badge {
            background: linear-gradient(135deg, #00d4ff, #7c77c6);
            color: #ffffff;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 10px;
        }

        .usage-card.selected .card-title {
            background: linear-gradient(135deg, #00d4ff, #7c77c6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .card-description {
            color: #8a8eb5;
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 0.95rem;
        }

        .card-details {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 20px;
            margin-bottom: 20px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 0;
        }

        .detail-item:last-child {
            margin-bottom: 0;
        }

        .detail-label {
            color: #b0b3d1;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .detail-value {
            color: #ffffff;
            font-weight: 600;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.05);
            padding: 4px 8px;
            border-radius: 6px;
        }

        .selection-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.3s ease;
        }

        .usage-card.selected .selection-indicator {
            opacity: 1;
            transform: translateX(0);
        }

        .check-circle {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #28a745, #20c997);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffffff;
            font-size: 12px;
            font-weight: bold;
        }

        .selection-text {
            font-size: 12px;
            color: #20c997;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .pattern-summary {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            margin-top: 30px;
        }

        .summary-content h4 {
            color: #ffffff;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .summary-content p {
            color: #8a8eb5;
            line-height: 1.6;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            gap: 15px;
        }

        .btn {
            padding: 12px 30px;
            border-radius: 12px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            position: relative;
            overflow: hidden;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #b0b3d1;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .btn-primary {
            background: linear-gradient(135deg, #00d4ff, #7c77c6);
            color: #ffffff;
            box-shadow: 0 10px 30px rgba(120, 119, 198, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(120, 119, 198, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn.loading {
            position: relative;
            color: transparent !important;
        }

        .btn.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            border: 2px solid #ffffff;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .form-section {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-group label {
            display: block;
            color: #b0b3d1;
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 12px 16px;
            color: #ffffff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #7c77c6;
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 0 20px rgba(124, 119, 198, 0.3);
        }

        .form-input::placeholder {
            color: #6a6d8a;
        }

        .form-input.info-only {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.05);
            color: #b0b3d1;
            cursor: default;
        }

        .form-input.info-only:focus {
            border-color: rgba(255, 255, 255, 0.05);
            box-shadow: none;
        }

        .equipment-section {
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-header h3 {
            color: #ffffff;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .add-btn {
            background: linear-gradient(135deg, #00d4ff, #7c77c6);
            color: #ffffff;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(124, 119, 198, 0.4);
        }

        .equipment-list {
            min-height: 60px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 12px;
            border: 2px dashed rgba(255, 255, 255, 0.1);
            padding: 20px;
            text-align: center;
            color: #8a8eb5;
        }

        .equipment-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .equipment-item:last-child {
            margin-bottom: 0;
        }

        .equipment-info h4 {
            color: #ffffff;
            margin-bottom: 5px;
        }

        .equipment-info p {
            color: #8a8eb5;
            font-size: 0.9rem;
        }

        .remove-btn {
            background: rgba(255, 77, 77, 0.2);
            color: #ff6b6b;
            border: none;
            padding: 5px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-btn:hover {
            background: rgba(255, 77, 77, 0.3);
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-5px);
            border-color: rgba(124, 119, 198, 0.3);
        }

        .result-card.highlight {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(124, 119, 198, 0.1));
            border-color: rgba(124, 119, 198, 0.3);
        }

        .result-icon {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .result-card h3 {
            color: #b0b3d1;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .result-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 5px;
        }

        .result-card.highlight .result-value {
            background: linear-gradient(135deg, #00d4ff, #7c77c6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .result-subtitle {
            color: #8a8eb5;
            font-size: 0.8rem;
        }

        .equipment-savings {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
            margin-bottom: 20px;
        }

        .recommendations {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
        }

        .recommendations h3 {
            color: #ffffff;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .rec-list {
            color: #b0b3d1;
            line-height: 1.6;
        }

        .rec-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #00d4ff;
        }

        .rec-item h4 {
            color: #00d4ff;
            margin-bottom: 5px;
        }

        .roi-chart {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
        }

        .error-message {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -20px); }
            to { opacity: 1; transform: translate(-50%, 0); }
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            .results-grid {
                grid-template-columns: 1fr;
            }
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            .container { padding: 15px; }
            .calculator-card { padding: 20px; border-radius: 20px; }
            .nav-buttons { flex-direction: column; gap: 10px; }
            .btn { width: 100%; padding: 15px; }
            .usage-patterns-grid { grid-template-columns: 1fr; gap: 15px; }
            .equipment-item { flex-direction: column; align-items: flex-start; gap: 10px; }
            .equipment-info { width: 100%; }
            .remove-btn { align-self: flex-end; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Energy Savings Calculator</h1>
            <h2>Discover Your Potential Savings</h2>
            <p>Calculate your energy costs and see how much you could save with smart energy choices.</p>
        </div>

        <div class="calculator-card">
            <div class="nav-container">
                <div class="nav-steps">
                    <div class="nav-step active" data-step="1">
                        <div class="step-circle active">1</div>
                        <div class="step-label">Basic Info</div>
                    </div>
                    <div class="nav-step" data-step="2">
                        <div class="step-circle">2</div>
                        <div class="step-label">Usage Pattern</div>
                    </div>
                    <div class="nav-step" data-step="3">
                        <div class="step-circle">3</div>
                        <div class="step-label">Equipment</div>
                    </div>
                    <div class="nav-step" data-step="4">
                        <div class="step-circle">4</div>
                        <div class="step-label">Results</div>
                    </div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 25%"></div>
                    </div>
                    <div class="progress-text" id="progress-text">Step 1 of 4 - Basic Info</div>
                </div>
            </div>

            <div class="screen-container">
                <div class="screen active" id="screen-1">
                    <h2 class="screen-title">Basic Information</h2>
                    <p class="screen-description">Tell us about your facility to get personalized energy calculations.</p>
                    
                    <div class="form-section">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="facility-type">Facility Type</label>
                                <select id="facility-type" class="form-input info-only">
                                    <option value="">Select type...</option>
                                    <option value="office">Office Building</option>
                                    <option value="retail">Retail Store</option>
                                    <option value="warehouse">Warehouse</option>
                                    <option value="manufacturing">Manufacturing</option>
                                    <option value="healthcare">Healthcare</option>
                                    <option value="education">Education</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="facility-size">Square Footage</label>
                                <input type="number" id="facility-size" placeholder="10000" class="form-input info-only">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="state-region">State/Region</label>
                                <select id="state-region" class="form-input">
                                    <option value="">Select state/region...</option>
                                    <option value="CA">California</option>
                                    <option value="NY">New York</option>
                                    <option value="TX">Texas</option>
                                    <option value="FL">Florida</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="energy-rate">Cost per kWh (¬¢)</label>
                                <input type="number" id="energy-rate" placeholder="12" step="0.1" class="form-input">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="current-bill">Monthly Electric Bill ($)</label>
                            <input type="number" id="current-bill" placeholder="2500" class="form-input">
                        </div>
                    </div>
                </div>

                <div class="screen" id="screen-2">
                    <h2 class="screen-title">Usage Pattern</h2>
                    <p class="screen-description">Select the operating schedule that best matches your facility.</p>
                    
                    <div class="usage-patterns-grid">
                        <div class="usage-card" data-pattern="office" onclick="selectUsagePattern('office')">
                            <div class="card-header">
                                <div class="card-icon">üè¢</div>
                                <div class="card-badge">Most Common</div>
                            </div>
                            <h3 class="card-title">Office Hours</h3>
                            <p class="card-description">Standard business operations with weekday schedules.</p>
                            
                            <div class="card-details">
                                <div class="detail-item">
                                    <span class="detail-label">Operating Hours:</span>
                                    <span class="detail-value">8 AM - 6 PM</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Weekly Schedule:</span>
                                    <span class="detail-value">Monday - Friday</span>
                                </div>
                            </div>
                            
                            <div class="selection-indicator">
                                <div class="check-circle">‚úì</div>
                                <span class="selection-text">Selected</span>
                            </div>
                        </div>

                        <div class="usage-card" data-pattern="retail" onclick="selectUsagePattern('retail')">
                            <div class="card-header">
                                <div class="card-icon">üõçÔ∏è</div>
                                <div class="card-badge">Extended Hours</div>
                            </div>
                            <h3 class="card-title">Commercial Retail</h3>
                            <p class="card-description">Extended hours including evenings and weekends.</p>
                            
                            <div class="card-details">
                                <div class="detail-item">
                                    <span class="detail-label">Operating Hours:</span>
                                    <span class="detail-value">9 AM - 9 PM</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Weekly Schedule:</span>
                                    <span class="detail-value">7 Days a Week</span>
                                </div>
                            </div>
                            
                            <div class="selection-indicator">
                                <div class="check-circle">‚úì</div>
                                <span class="selection-text">Selected</span>
                            </div>
                        </div>

                        <div class="usage-card" data-pattern="continuous" onclick="selectUsagePattern('continuous')">
                            <div class="card-header">
                                <div class="card-icon">üîÑ</div>
                                <div class="card-badge">Continuous</div>
                            </div>
                            <h3 class="card-title">24/7 Operation</h3>
                            <p class="card-description">Continuous operations requiring constant energy supply.</p>
                            
                            <div class="card-details">
                                <div class="detail-item">
                                    <span class="detail-label">Operating Hours:</span>
                                    <span class="detail-value">24 Hours</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Weekly Schedule:</span>
                                    <span class="detail-value">7 Days a Week</span>
                                </div>
                            </div>
                            
                            <div class="selection-indicator">
                                <div class="check-circle">‚úì</div>
                                <span class="selection-text">Selected</span>
                            </div>
                        </div>
                    </div>

                    <div class="pattern-summary" id="pattern-summary" style="display: none;">
                        <div class="summary-content">
                            <h4>Selected: <span id="selected-pattern-name"></span></h4>
                            <p id="selected-pattern-description"></p>
                        </div>
                    </div>
                </div>

                <div class="screen" id="screen-3">
                    <h2 class="screen-title">Equipment Inventory</h2>
                    <p class="screen-description">Add your equipment to calculate accurate savings potential.</p>
                    
                    <div class="equipment-section">
                        <div class="section-header">
                            <h3>Single Compressor HVAC</h3>
                            <button class="add-btn" onclick="addEquipment('hvac-single')">+ Add System</button>
                        </div>
                        <div id="hvac-single-list" class="equipment-list">
                            <p>No systems added yet.</p>
                        </div>
                    </div>
                    
                    <div class="equipment-section">
                        <div class="section-header">
                            <h3>Multi Compressor HVAC</h3>
                            <button class="add-btn" onclick="addEquipment('hvac-multi')">+ Add System</button>
                        </div>
                        <div id="hvac-multi-list" class="equipment-list">
                            <p>No systems added yet.</p>
                        </div>
                    </div>
                    
                    <div class="equipment-section">
                        <div class="section-header">
                            <h3>Refrigeration Systems</h3>
                            <button class="add-btn" onclick="addEquipment('refrigeration')">+ Add System</button>
                        </div>
                        <div id="refrigeration-list" class="equipment-list">
                            <p>No systems added yet.</p>
                        </div>
                    </div>
                    
                    <div class="equipment-section">
                        <div class="section-header">
                            <h3>Breaker Boxes</h3>
                            <button class="add-btn" onclick="addEquipment('breaker')">+ Add Breaker Box</button>
                        </div>
                        <div id="breaker-list" class="equipment-list">
                            <p>No breaker boxes added yet.</p>
                        </div>
                    </div>
                </div>

                <div class="screen" id="screen-4">
                    <h2 class="screen-title">Your Energy Savings Analysis</h2>
                    <p class="screen-description">Based on your facility, usage pattern, and equipment.</p>
                    
                    <div class="results-grid">
                        <div class="result-card highlight">
                            <div class="result-icon">üí∞</div>
                            <h3>Total Annual Savings</h3>
                            <div class="result-value" id="annual-savings">$0</div>
                            <div class="result-subtitle">Across all equipment</div>
                        </div>
                        
                        <div class="result-card">
                            <div class="result-icon">üìÖ</div>
                            <h3>Monthly Savings</h3>
                            <div class="result-value" id="monthly-savings">$0</div>
                            <div class="result-subtitle">Consistent reduction</div>
                        </div>
                        
                        <div class="result-card">
                            <div class="result-icon">üè¢</div>
                            <h3>Usage Pattern</h3>
                            <div class="result-value" id="usage-pattern-display">None Selected</div>
                            <div class="result-subtitle">Operating schedule</div>
                        </div>
                        
                        <div class="result-card">
                            <div class="result-icon">‚ö°</div>
                            <h3>Energy Reduction</h3>
                            <div class="result-value" id="energy-reduction">0%</div>
                            <div class="result-subtitle">Efficiency gain</div>
                        </div>
                    </div>
                    
                    <div class="equipment-savings">
                        <h3>Equipment Savings Breakdown</h3>
                        <div id="equipment-savings-list" class="rec-list"></div>
                    </div>
                    
                    <div class="recommendations">
                        <h3>Recommendations</h3>
                        <div class="rec-list" id="rec-list">
                            <p>Complete the previous steps to see personalized recommendations.</p>
                        </div>
                    </div>
                    
                    <div class="roi-chart">
                        <h3>Return on Investment</h3>
                        <canvas id="roi-chart" style="max-height: 200px;"></canvas>
                    </div>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-secondary" id="prev-btn" disabled>Previous</button>
                <button class="btn btn-primary" id="next-btn">Next Step</button>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentStep = 1;
        let equipmentCounter = 0;
        const totalSteps = 4;
        let userSelections = {
            usagePattern: null,
            facilityData: {},
            equipment: []
        };

        // DOM elements
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const steps = document.querySelectorAll('.nav-step');
        const screens = document.querySelectorAll('.screen');
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');

        // Screen names
        const screenNames = {
            1: 'Basic Info',
            2: 'Usage Pattern',
            3: 'Equipment Inventory',
            4: 'Results'
        };

        function updateStep(step) {
            if (step < 1 || step > totalSteps) return;

            steps.forEach((s, index) => {
                const circle = s.querySelector('.step-circle');
                s.classList.toggle('active', index + 1 <= step);
                circle.classList.toggle('active', index + 1 <= step);
            });

            screens.forEach((screen, index) => {
                const targetStep = index + 1;
                screen.classList.remove('active', 'prev');
                if (targetStep === step) {
                    screen.classList.add('active');
                } else if (targetStep < step) {
                    screen.classList.add('prev');
                }
            });

            const progressPercentage = (step / totalSteps) * 100;
            progressFill.style.width = `${progressPercentage}%`;
            progressText.textContent = `Step ${step} of ${totalSteps} - ${screenNames[step]}`;

            prevBtn.disabled = step === 1;
            nextBtn.textContent = step === totalSteps ? 'Complete' : 'Next Step';
            currentStep = step;
            if (step === 4) updateResults();
        }

        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.innerHTML = message;
            errorDiv.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(255, 77, 77, 0.9);
                color: white;
                padding: 15px 30px;
                border-radius: 8px;
                z-index: 1000;
                max-width: 80%;
                text-align: center;
            `;
            document.body.appendChild(errorDiv);
            setTimeout(() => errorDiv.remove(), 3000);
        }

        function validateScreen1() {
            const facilityType = document.getElementById('facility-type').value;
            const facilitySize = document.getElementById('facility-size').value;
            const stateRegion = document.getElementById('state-region').value;
            const energyRate = document.getElementById('energy-rate').value;
            const currentBill = document.getElementById('current-bill').value;

            const errors = [];
            if (!facilityType) errors.push('Please select a facility type');
            if (!facilitySize || facilitySize <= 0) errors.push('Square footage must be greater than 0');
            if (!stateRegion) errors.push('Please select a state/region');
            if (!energyRate || energyRate <= 0 || energyRate > 100) errors.push('Cost per kWh must be between 0 and 100 cents');
            if (!currentBill || currentBill <= 0 || currentBill > 100000) errors.push('Monthly bill must be between 0 and $100,000');

            if (errors.length > 0) {
                showError(errors.join('<br>'));
                return false;
            }

            userSelections.facilityData = { facilityType, facilitySize, stateRegion, energyRate, currentBill };
            return true;
        }

        function validateScreen2() {
            if (!userSelections.usagePattern) {
                showError('Please select a usage pattern');
                return false;
            }
            return true;
        }

        function validateScreen3() {
            if (userSelections.equipment.length === 0) {
                showError('Please add at least one equipment item');
                return false;
            }
            for (let item of userSelections.equipment) {
                if (item.quantity <= 0) {
                    showError(`Quantity for ${item.name} must be greater than 0`);
                    return false;
                }
                if (item.type.includes('hvac') && (item.tonnage <= 0 || item.tonnage > 100)) {
                    showError(`Tonnage for ${item.name} must be between 0 and 100`);
                    return false;
                }
                if (item.type === 'refrigeration' && (item.hp <= 0 || item.hp > 500)) {
                    showError(`Horsepower for ${item.name} must be between 0 and 500`);
                    return false;
                }
            }
            return true;
        }

        function selectUsagePattern(pattern) {
            document.querySelectorAll('.usage-card').forEach(card => card.classList.remove('selected'));
            const selectedCard = document.querySelector(`[data-pattern="${pattern}"]`);
            selectedCard.classList.add('selected');
            userSelections.usagePattern = pattern;

            const patterns = {
                office: { name: 'Office Hours', desc: 'Standard business operations, 8 AM - 6 PM, Monday - Friday.' },
                retail: { name: 'Commercial Retail', desc: 'Extended hours, 9 AM - 9 PM, 7 days a week.' },
                continuous: { name: '24/7 Operation', desc: 'Continuous operations, 24 hours, 7 days a week.' }
            };

            const summaryElement = document.getElementById('pattern-summary');
            const nameElement = document.getElementById('selected-pattern-name');
            const descriptionElement = document.getElementById('selected-pattern-description');

            nameElement.textContent = patterns[pattern].name;
            descriptionElement.textContent = patterns[pattern].desc;
            summaryElement.style.display = 'block';
        }

        function addEquipment(type) {
            equipmentCounter++;
            const equipmentTypes = {
                'hvac-single': { name: 'Single Compressor HVAC', savingsRange: [15, 30], fields: ['quantity', 'tonnage'] },
                'hvac-multi': { name: 'Multi Compressor HVAC', savingsRange: [20, 35], fields: ['quantity', 'tonnage'] },
                'refrigeration': { name: 'Refrigeration System', savingsRange: [10, 25], fields: ['quantity', 'hp'] },
                'breaker': { name: 'Breaker Box', savingsRange: [5, 15], fields: ['quantity'] }
            };
            
            const config = equipmentTypes[type];
            const item = {
                id: equipmentCounter,
                type: type,
                name: `${config.name} ${equipmentCounter}`,
                quantity: 1,
                tonnage: type.includes('hvac') ? 5 : 0,
                hp: type === 'refrigeration' ? 10 : 0,
                savings: config.savingsRange[0]
            };
            
            userSelections.equipment.push(item);
            
            const listElement = document.getElementById(`${type}-list`);
            let inputsHtml = `
                <div class="form-group">
                    <label>Quantity</label>
                    <input type="number" min="1" value="${item.quantity}" onchange="updateEquipment(${equipmentCounter}, 'quantity', this.value)" class="form-input">
                </div>
            `;
            
            if (type.includes('hvac')) {
                inputsHtml += `
                    <div class="form-group">
                        <label>Tonnage</label>
                        <input type="number" min="1" value="${item.tonnage}" step="0.1" onchange="updateEquipment(${equipmentCounter}, 'tonnage', this.value)" class="form-input">
                    </div>
                `;
            } else if (type === 'refrigeration') {
                inputsHtml += `
                    <div class="form-group">
                        <label>Horsepower (HP)</label>
                        <input type="number" min="1" value="${item.hp}" step="0.1" onchange="updateEquipment(${equipmentCounter}, 'hp', this.value)" class="form-input">
                    </div>
                `;
            }
            
            inputsHtml += `
                <div class="form-group">
                    <label>Savings Assumption (${config.savingsRange[0]}-${config.savingsRange[1]}%)</label>
                    <input type="range" min="${config.savingsRange[0]}" max="${config.savingsRange[1]}" value="${item.savings}" oninput="updateEquipment(${equipmentCounter}, 'savings', this.value); this.nextElementSibling.textContent = this.value + '%'" class="form-input">
                    <span>${item.savings}%</span>
                </div>
            `;
            
            const itemHtml = `
                <div class="equipment-item" id="equipment-${equipmentCounter}">
                    <div class="equipment-info">
                        <h4>${item.name}</h4>
                        ${inputsHtml}
                    </div>
                    <button class="remove-btn" onclick="removeEquipment(${equipmentCounter}, '${type}')">Remove</button>
                </div>
            `;
            
            if (listElement.innerHTML.includes('No ')) {
                listElement.innerHTML = '';
            }
            listElement.innerHTML += itemHtml;
        }

        function updateEquipment(id, field, value) {
            const equipment = userSelections.equipment.find(eq => eq.id === id);
            if (equipment) {
                equipment[field] = parseFloat(value) || 0;
                updateResults();
            }
        }

        function removeEquipment(id, type) {
            userSelections.equipment = userSelections.equipment.filter(eq => eq.id !== id);
            document.getElementById(`equipment-${id}`).remove();
            
            const listElement = document.getElementById(`${type}-list`);
            if (listElement.children.length === 0) {
                listElement.innerHTML = `<p>No ${type.includes('hvac') ? 'systems' : type === 'refrigeration' ? 'systems' : 'breaker boxes'} added yet.</p>`;
            }
            updateResults();
        }

        function calculateSavings() {
            const { facilityData, usagePattern, equipment } = userSelections;
            const monthlyBill = parseFloat(facilityData.currentBill) || 2500;
            const energyRate = parseFloat(facilityData.energyRate) || 12;
            const facilitySize = parseFloat(facilityData.facilitySize) || 10000;

            const patternMultipliers = {
                office: 1.0,
                retail: 1.2,
                continuous: 1.5
            };
            const multiplier = patternMultipliers[usagePattern] || 1.0;

            const equipmentSavings = equipment.map(item => {
                let baseEnergyUsage;
                switch (item.type) {
                    case 'hvac-single':
                        baseEnergyUsage = item.quantity * item.tonnage * 1.2;
                        break;
                    case 'hvac-multi':
                        baseEnergyUsage = item.quantity * item.tonnage * 1.5;
                        break;
                    case 'refrigeration':
                        baseEnergyUsage = item.quantity * item.hp * 0.75;
                        break;
                    case 'breaker':
                        baseEnergyUsage = item.quantity * 0.5;
                        break;
                    default:
                        baseEnergyUsage = 0;
                }
                const monthlyEnergy = baseEnergyUsage * 720;
                const monthlyCost = (monthlyEnergy * energyRate) / 100;
                const savings = monthlyCost * (item.savings / 100);
                return { ...item, monthlySavings: savings, annualSavings: savings * 12 };
            });

            const totalMonthlySavings = equipmentSavings.reduce((sum, item) => sum + item.monthlySavings, 0) * multiplier;
            const totalAnnualSavings = totalMonthlySavings * 12;
            const totalSavingsPercent = (totalMonthlySavings / monthlyBill) * 100;

            const results = {
                equipmentSavings,
                totalMonthlySavings,
                totalAnnualSavings,
                totalSavingsPercent,
                usagePattern
            };

            console.log('Calculation Results:', results);
            return results;
        }

        function updateResults() {
            if (currentStep !== 4) return;
            const results = calculateSavings();
            
            document.getElementById('annual-savings').textContent = `$${results.totalAnnualSavings.toLocaleString(undefined, { maximumFractionDigits: 0 })}`;
            document.getElementById('monthly-savings').textContent = `$${results.totalMonthlySavings.toLocaleString(undefined, { maximumFractionDigits: 0 })}`;
            document.getElementById('energy-reduction').textContent = `${Math.round(results.totalSavingsPercent)}%`;
            document.getElementById('usage-pattern-display').textContent = {
                office: 'Office Hours',
                retail: 'Commercial Retail',
                continuous: '24/7 Operation'
            }[results.usagePattern] || 'Not Selected';

            const savingsList = document.getElementById('equipment-savings-list');
            savingsList.innerHTML = results.equipmentSavings.map(item => `
                <div class="rec-item">
                    <h4>${item.name}</h4>
                    <p>Monthly: $${item.monthlySavings.toLocaleString(undefined, { maximumFractionDigits: 0 })} | Annual: $${item.annualSavings.toLocaleString(undefined, { maximumFractionDigits: 0 })}</p>
                </div>
            `).join('');

            const recList = document.getElementById('rec-list');
            let recommendations = '';
            if (!userSelections.usagePattern || results.equipmentSavings.length === 0) {
                recommendations = '<p>Complete the previous steps to see personalized recommendations.</p>';
            } else {
                recommendations = `
                    <div class="rec-item">
                        <h4>Optimize ${results.usagePattern}</h4>
                        <p>Adjust schedules and maintenance for ${results.equipmentSavings.length} equipment items to save up to ${Math.round(results.totalSavingsPercent)}%.</p>
                    </div>
                    <div class="rec-item">
                        <h4>Upgrade Equipment</h4>
                        <p>Consider energy-efficient replacements for high-consumption systems.</p>
                    </div>
                    <div class="rec-item">
                        <h4>Energy Audit</h4>
                        <p>Schedule a professional audit for detailed savings opportunities.</p>
                    </div>
                `;
            }
            recList.innerHTML = recommendations;

            const ctx = document.getElementById('roi-chart').getContext('2d');
            const investmentCost = results.equipmentSavings.length * 5000;
            const years = [1, 2, 3, 4, 5];
            const roiData = years.map(year => results.totalAnnualSavings * year - investmentCost);

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years.map(y => `Year ${y}`),
                    datasets: [{
                        label: 'Cumulative ROI ($)',
                        data: roiData,
                        borderColor: '#00d4ff',
                        backgroundColor: 'rgba(0, 212, 255, 0.2)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        function setLoading(button, isLoading) {
            button.classList.toggle('loading', isLoading);
            button.disabled = isLoading;
        }

        nextBtn.addEventListener('click', () => {
            setLoading(nextBtn, true);
            setTimeout(() => {
                if (currentStep === 1 && !validateScreen1()) {
                    setLoading(nextBtn, false);
                    return;
                }
                if (currentStep === 2 && !validateScreen2()) {
                    setLoading(nextBtn, false);
                    return;
                }
                if (currentStep === 3 && !validateScreen3()) {
                    setLoading(nextBtn, false);
                    return;
                }
                if (currentStep < totalSteps) updateStep(currentStep + 1);
                setLoading(nextBtn, false);
            }, 500);
        });

        prevBtn.addEventListener('click', () => {
            setLoading(prevBtn, true);
            setTimeout(() => {
                if (currentStep > 1) updateStep(currentStep - 1);
                setLoading(prevBtn, false);
            }, 500);
        });

        steps.forEach((step, index) => {
            step.addEventListener('click', () => updateStep(index + 1));
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' && currentStep < totalSteps) updateStep(currentStep + 1);
            else if (e.key === 'ArrowLeft' && currentStep > 1) updateStep(currentStep - 1);
        });
    </script>
</body>
</html>
